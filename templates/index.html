<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Ensure proper mobile scaling -->
    <title>Harp & Soph Life Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"> <!-- Use Google Fonts for consistency -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Roboto', sans-serif; /* More readable font */
            background-color: #ffccf9; /* Light pink background */
            text-align: center;
            padding: 20px;
            margin: 0;
        }
        h1, h2 {
            color: #ff66cc; /* Soft pink color for the headings */
        }
        table {
    	    width: auto; /* Only as wide as its content requires */
            margin: 20px auto;
            border-collapse: collapse;
            border-radius: 15px; /* Rounded corners for the table */
            overflow: hidden; /* Ensures the rounded corners affect child elements */
            box-shadow: 0 0 10px #888888; /* Soft shadow for depth */
	}
        th, td {
            border: 1px solid #ff99cc; /* Light pink border for table cells */
            padding: 9px;
            text-align: left;           
            border-radius: 10px; /* Rounded corners for table cells */
        }
        th {
            background-color: #ff66cc; /* Deeper pink for the header */
            color: white;
            font-size: 1.2em;
        }
        tr:nth-child(even) {
            background-color: #ffccf9; /* Light pink for even rows */
        }
        tr:hover {
            background-color: #ffb3e6; /* Slightly darker pink on hover */
        }
	@media (max-width: 768px) {
    th, td {
        padding: 4px 6px; /* Even smaller padding for smaller screens */
        font-size: smaller; /* Reduce font size on small screens */
    }
    table {
        width: 100%; /* Full width on smaller screens */
        max-width: none; /* Override max-width of 80% */
        box-sizing: border-box; /* Include padding and border in the width */
    }
}
        .content-image {
            max-width: 100%; /* Full width on smaller screens */
            height: auto;
            display: block;
            margin: 20px auto;
            cursor: pointer; /* Indicates the image can be clicked */
        }
        @media (min-width: 768px) { /* For desktop screens */
            .content-image {
                max-width: 50%; /* Adjust to a reasonable size on desktop */
            }
        }
        /* Gallery overlay styling */
#galleryOverlay {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1001; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0,0,0,0.9); /* Black w/ opacity */
    padding-top: 50px; /* Adds some space at the top */
}

/* Close button */
.closeBtn {
    position: fixed;
    top: 15px;
    right: 35px;
    color: #fff;
    font-size: 40px;
    font-weight: bold;
    cursor: pointer;
}

/* Gallery container */
.gallery-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    padding: 0 4px;
}

/* Gallery images */
.galleryImg {
    margin: 10px;
    max-width: 90%;
    width: auto; /* Adjust width to maintain aspect ratio */
    max-height: 400px; /* Limiting the height for larger displays */
    transition: transform 0.2s; /* Animation */
    cursor: pointer; /* Indicates the image can be clicked */
}

@media (min-width: 768px) { /* For desktop screens */
    .galleryImg {
        max-width: 45%; /* Adjust to display more images in a row on desktop */
    }
}

@media (min-width: 1024px) { /* Larger desktop screens */
    .galleryImg {
        max-width: 30%; /* Further adjust for larger screens */
    }
}
        .galleryImg:hover {
            transform: scale(1.1); /* Slight zoom on hover */
        }
    </style>
</head>
<body>
    <div id="currentDateTime" class="timestamp"></div>
    <div class="timestamp">Last Updated On: {{ last_updated }}</div>

    <script>
        function updateDateTime() {
            const now = new Date();
            const options = {
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric',
                hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true
            };
            document.getElementById("currentDateTime").innerHTML = now.toLocaleString("en-US", options);
        }
        updateDateTime(); // Run once on load
        setInterval(updateDateTime, 1000); // Update every second
        // Function to toggle gallery overlay
        function toggleGallery(show) {
            document.getElementById('galleryOverlay').style.display = show ? 'block' : 'none';
        }
    </script>

    <h1>Harper and Sophie's Life Tracker</h1>
    <!-- Clickable feature image that opens the gallery -->
    <img src="{{ url_for('static', filename='assets/images/girlsbasket.jpg') }}" alt="Photo of the girls in basket day 2 of life" class="content-image" onclick="toggleGallery(true)">

    <!-- Gallery Overlay -->
    <div id="galleryOverlay">
        <span class="closeBtn" onclick="toggleGallery(false)">&times;</span>
        <!-- Dynamically loaded images from Flask -->
        {% for image in image_files %}
        <img src="{{ url_for('static', filename=image) }}" class="galleryImg" alt="Gallery Image">
        {% endfor %}
    </div>

    <h2>Last Event Times</h2>
    <div style="display: flex; justify-content: space-around;">
        <div>
            <h3>Feedings</h3>
            <table>
                <tr>
                    <th>Activity Type</th>
                    <th>Last Time</th>
                </tr>
                {% for key, time in last_event_times['Feeding'].items() %}
                <tr>
                    <td>{{ key }}</td>
                    <td>{{ time }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
        <div>
            <h3>Diapers</h3>
            <table>
                <tr>
                    <th>Activity Type</th>
                    <th>Last Time</th>
                </tr>
                {% for key, time in last_event_times['Diapers'].items() %}
                <tr>
                    <td>{{ key }}</td>
                    <td>{{ time }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
    
    <h2>Events in the Last 3 Days</h2>
<div style="display: flex; flex-wrap: wrap; justify-content: space-around;">
    {% for category, labels in events_last_3_days.items() %}
        <div style="margin: 10px;">
            <h3>{{ category }}</h3>
            <div style="margin-bottom: 20px; border: 1px solid #ff99cc; border-radius: 15px; overflow: hidden; box-shadow: 0 0 10px #888888;">
                {% for label, events in labels.items() %}
                    <h4 style="background-color: #ff66cc; color: white; margin: 0; padding: 4px;">{{ label }}</h4>
                    <table style="width: 100%; margin-bottom: 0; border-radius: 0;">
                        <tbody>
                            {% for event in events %}
                                <tr>
                                    <td style="padding: 4px; border-bottom: 1px solid #ff99cc;">{{ event.timestamp.split(' at ')[0] }}</td>
                                    <td style="padding: 4px; border-bottom: 1px solid #ff99cc;">{{ event.timestamp.split(' at ')[1] }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% endfor %}
            </div>
        </div>
    {% endfor %}
</div>
    
    <!-- Chart Canvas -->
    <img src="{{ url_for('activity_plot') }}" alt="Activity Chart" style="max-width: 100%; height: auto;">
    
    <h2>Today's Counts</h2>
    <table>
        <tr>
            <th>Activity Type</th>
            <th>Today's Count</th>
        </tr>
        {% for key, count in today_counts.items() %}
        <tr>
            <td>{{ key }}</td>
            <td>{{ count }}</td>
        </tr>
        {% endfor %}
    </table>

    <h2>Total Counts</h2>
    <table>
        <tr>
            <th>Activity Type</th>
            <th>Total Count</th>
        </tr>
        {% for key, count in key_counts.items() %}
        <tr>
            <td>{{ key }}</td>
            <td>{{ count }}</td>
        </tr>
        {% endfor %}
    </table>

    <h2>Average Counts Per Day</h2>
    <table>
        <tr>
            <th>Activity Type</th>
            <th>Average Count</th>
        </tr>
        {% for key, avg in average_counts_per_day.items() %}
        <tr>
            <td>{{ key }}</td>
            <td>{{ avg }}</td>
        </tr>
        {% endfor %}
    </table>

</body>
</html>

